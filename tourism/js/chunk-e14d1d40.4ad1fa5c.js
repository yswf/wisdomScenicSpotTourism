(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e14d1d40"],{"04b8":function(t,e,i){"use strict";i.d(e,"a",(function(){return s})),i.d(e,"e",(function(){return c})),i.d(e,"d",(function(){return n})),i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return r}));i("e25e"),i("1276");function s(t){var e=/^(([1][1-5])|([2][1-3])|([3][1-7])|([4][1-6])|([5][0-4])|([6][1-5])|([7][1])|([8][1-2]))\d{4}(([1][9]\d{2})|([2]\d{3}))(([0][1-9])|([1][0-2]))(([0][1-9])|([1-2][0-9])|([3][0-1]))\d{3}[0-9xX]$/;if(!e.test(t))return!1;var i=t.substr(6,4),s=t.substr(10,2),c=t.substr(12,2),n=Date.parse(s+"-"+c+"-"+i),a=Date.parse(new Date),r=new Date(i,s,0).getDate();if(n>a||c>r)return!1;for(var o=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],l=["1","0","X","9","8","7","6","5","4","3","2"],u=t.split(""),f=0,d=0;d<17;d++)f+=parseInt(u[d])*parseInt(o[d]);return u[17].toUpperCase()===l[f%11].toUpperCase()}function c(t){var e=/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{8,32}$/;return!!e.test(t)}function n(t){var e=/^1[34578]\d{9}$/;return!!e.test(t)}function a(t){var e=/^[\u4e00-\u9fa5]{2,6}$/;return!!e.test(t)}function r(t){if("string"===typeof t)return!t;for(var e=0;e<t.length;e++)if(r(t[e]))return!0;return!1}},"08b2":function(t,e,i){"use strict";var s=i("8ca9"),c=i.n(s);c.a},"159b":function(t,e,i){var s=i("da84"),c=i("fdbc"),n=i("17c2"),a=i("9112");for(var r in c){var o=s[r],l=o&&o.prototype;if(l&&l.forEach!==n)try{a(l,"forEach",n)}catch(u){l.forEach=n}}},"17c2":function(t,e,i){"use strict";var s=i("b727").forEach,c=i("b301");t.exports=c("forEach")?function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}:[].forEach},"8ca9":function(t,e,i){},a434:function(t,e,i){"use strict";var s=i("23e7"),c=i("23cb"),n=i("a691"),a=i("50c4"),r=i("7b0b"),o=i("65f0"),l=i("8418"),u=i("1dde"),f=Math.max,d=Math.min,p=9007199254740991,h="Maximum allowed length exceeded";s({target:"Array",proto:!0,forced:!u("splice")},{splice:function(t,e){var i,s,u,v,k,b,m=r(this),g=a(m.length),C=c(t,g),_=arguments.length;if(0===_?i=s=0:1===_?(i=0,s=g-C):(i=_-2,s=d(f(n(e),0),g-C)),g+i-s>p)throw TypeError(h);for(u=o(m,s),v=0;v<s;v++)k=C+v,k in m&&l(u,v,m[k]);if(u.length=s,i<s){for(v=C;v<g-s;v++)k=v+s,b=v+i,k in m?m[b]=m[k]:delete m[b];for(v=g;v>g-s+i;v--)delete m[v-1]}else if(i>s)for(v=g-s;v>C;v--)k=v+s-1,b=v+i-1,k in m?m[b]=m[k]:delete m[b];for(v=0;v<i;v++)m[v+C]=arguments[v+2];return m.length=g-s+i,u}})},a9e3:function(t,e,i){"use strict";var s=i("83ab"),c=i("da84"),n=i("94ca"),a=i("6eeb"),r=i("5135"),o=i("c6b6"),l=i("7156"),u=i("c04e"),f=i("d039"),d=i("7c73"),p=i("241c").f,h=i("06cf").f,v=i("9bf2").f,k=i("58a8").trim,b="Number",m=c[b],g=m.prototype,C=o(d(g))==b,_=function(t){var e,i,s,c,n,a,r,o,l=u(t,!1);if("string"==typeof l&&l.length>2)if(l=k(l),e=l.charCodeAt(0),43===e||45===e){if(i=l.charCodeAt(2),88===i||120===i)return NaN}else if(48===e){switch(l.charCodeAt(1)){case 66:case 98:s=2,c=49;break;case 79:case 111:s=8,c=55;break;default:return+l}for(n=l.slice(2),a=n.length,r=0;r<a;r++)if(o=n.charCodeAt(r),o<48||o>c)return NaN;return parseInt(n,s)}return+l};if(n(b,!m(" 0o1")||!m("0b1")||m("+0x1"))){for(var y,I=function(t){var e=arguments.length<1?0:t,i=this;return i instanceof I&&(C?f((function(){g.valueOf.call(i)})):o(i)!=b)?l(new m(_(e)),i,I):_(e)},T=s?p(m):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),D=0;T.length>D;D++)r(m,y=T[D])&&!r(I,y)&&v(I,y,h(m,y));I.prototype=g,g.constructor=I,a(c,b,I)}},b0c0:function(t,e,i){var s=i("83ab"),c=i("9bf2").f,n=Function.prototype,a=n.toString,r=/^\s*function ([^ (]*)/,o="name";!s||o in n||c(n,o,{configurable:!0,get:function(){try{return a.call(this).match(r)[1]}catch(t){return""}}})},e25e:function(t,e,i){var s=i("23e7"),c=i("e583");s({global:!0,forced:parseInt!=c},{parseInt:c})},e583:function(t,e,i){var s=i("da84"),c=i("58a8").trim,n=i("5899"),a=s.parseInt,r=/^[+-]?0[Xx]/,o=8!==a(n+"08")||22!==a(n+"0x16");t.exports=o?function(t,e){var i=c(String(t));return a(i,e>>>0||(r.test(i)?16:10))}:a},f825:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"ticketReservation"}},[i("div",{staticClass:"ticket-line"},[t._m(0),i("span",{staticClass:"ticket-select"},[t._v(t._s(t.ticketInfo.selectTicketType))])]),i("van-collapse",{attrs:{accordion:""},model:{value:t.ticketType,callback:function(e){t.ticketType=e},expression:"ticketType"}},t._l(t.ticketList,(function(e){return i("van-collapse-item",{attrs:{name:e.id}},[i("div",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(e.title)+" "),i("span",{staticClass:"ticket-price"},[t._v("￥"+t._s(e.price))])]),i("div",{staticClass:"ticket-detail"},[i("span",{staticClass:"ticket-desc"},[t._v(t._s(e.desc))]),i("span",{staticClass:"ticket-select-button",on:{click:function(i){return t.select(e)}}},[t._v("确定")])])])})),1),i("div",{staticClass:"ticket-line",on:{click:t.showPopup}},[t._m(1),t.ticketInfo.selectPlayDate?i("span",{staticClass:"ticket-select"},[t._v(t._s(t.ticketInfo.selectPlayDate))]):t._e(),t.ticketInfo.selectPlayDate?t._e():i("span",{staticClass:"icon iconfont ticket-select",staticStyle:{"margin-right":"25px"}},[t._v("")])]),i("div",{staticClass:"ticket-line"},[t._m(2),i("span",{staticClass:"ticket-select"},[t._v(t._s(t.touristList.length))])]),i("div",{staticClass:"tourist-list"},[t._l(t.touristList,(function(e){return i("div",{staticClass:"tourist-info"},[i("div",{staticStyle:{display:"flex"}},[i("div",{on:{click:function(i){return t.editTourist(e)}}},[i("span",{staticClass:"icon iconfont operator"},[t._v("")])]),i("div",{staticClass:"tourist-detail"},[i("div",[i("span",{staticClass:"tourist-name"},[t._v(t._s(e.name))])]),i("div",{staticClass:"tourist-idCard"},[t._v(t._s(t._f("idCardFilter")(e.idCard)))])])]),i("span",{staticClass:"icon iconfont delete",on:{click:function(i){return t.deleteTourist(e)}}},[t._v("")])])})),i("div",{staticClass:"addTourist",on:{click:t.addTourist}},[i("span",{staticClass:"icon iconfont icon-jia"}),i("span",{staticClass:"addTourist-text"},[t._v("添加游客")])])],2),i("div",{staticClass:"pay-button",on:{click:t.pay}},[t._v("￥"+t._s(t.ticketPay)+"/确认支付")]),i("van-popup",{attrs:{position:"bottom"},model:{value:t.showSelectPopup,callback:function(e){t.showSelectPopup=e},expression:"showSelectPopup"}},[i("van-datetime-picker",{staticClass:"datetime-picker",attrs:{title:t.title,type:t.type,"min-date":t.minDate,"max-date":t.maxDate},on:{confirm:t.confirmSelect,cancel:t.cancelSelect,change:t.getValues},model:{value:t.currentDate,callback:function(e){t.currentDate=e},expression:"currentDate"}})],1),i("van-popup",{model:{value:t.isEdit,callback:function(e){t.isEdit=e},expression:"isEdit"}},[i("van-cell-group",[i("van-field",{staticClass:"cellEdit",attrs:{clearable:"",label:"姓名",placeholder:"请输入姓名"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}}),i("van-field",{staticClass:"cellEdit",attrs:{clearable:"",label:"证件号码",placeholder:"请输入证件号码"},model:{value:t.idCard,callback:function(e){t.idCard=e},expression:"idCard"}})],1),i("div",{staticClass:"confirm-button",on:{click:t.editTourists}},[t._v("确定")])],1)],1)},c=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("span",{staticClass:"icon iconfont iconfont-title"},[t._v("")]),i("span",{staticClass:"ticket-title"},[t._v("购票类型")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("span",{staticClass:"icon iconfont iconfont-title"},[t._v("")]),i("span",{staticClass:"ticket-title"},[t._v("游玩日期")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("span",{staticClass:"icon iconfont iconfont-title"},[t._v("")]),i("span",{staticClass:"ticket-title"},[t._v("游玩人数")])])}],n=(i("a434"),i("b0c0"),i("a9e3"),i("159b"),i("e7e5"),i("d399")),a=(i("e17f"),i("2241")),r=i("5355"),o=i("04b8"),l={name:"ticketReservation",data:function(){return{ticketType:"",currentPlayDate:"",showSelectPopup:!1,title:"请选择游玩日期",type:"date",userTel:"",minDate:new Date,currentDate:new Date,ticketInfo:{ticketId:"",selectPlayDate:"",touristsNumber:"",ticketPay:"",uTel:"",selectTicketType:""},name:"",idCard:"",isEdit:!1,ticketList:[],touristList:[]}},filters:{idCardFilter:function(t){return t.substr(0,6)+"****"+t.substr(14)}},computed:{ticketPay:function(){for(var t=0,e=0,i=0;i<this.ticketList.length;i++)if(this.ticketInfo.selectTicketType==this.ticketList[i].title){e=this.ticketList[i].price;break}for(var s=0;s<this.touristList.length;s++){var c=e;"0"!=this.touristList[s].ticketType&&(c=e/2),t+=Number(c)}return t},maxDate:function(){var t=(new Date).valueOf(),e=t+6048e5;return e=new Date(e),e}},mounted:function(){this.userTel=sessionStorage.getItem("userTel"),this.getTicketData()},methods:{getTicketData:function(){var t=this;this.ticketList=[],Object(r["l"])({},"get").then((function(e){if(0!=e.length)for(var i={},s=0;s<e.length;s++)i={id:e[s].id,title:e[s].title,desc:e[s].descs,price:e[s].price},t.ticketList.push(i);else t.$message.success(e.msg)})).catch((function(e){console.log(22),t.$message.success("获取失败")}))},select:function(t){this.ticketInfo.ticketId=t.id,this.ticketInfo.selectTicketType=t.title,this.ticketType=""},showPopup:function(){this.showSelectPopup=!0},getValues:function(t){var e=t.children[0].options[t.children[0].currentIndex],i=t.children[1].options[t.children[1].currentIndex],s=t.children[2].options[t.children[2].currentIndex];this.currentPlayDate=e+"-"+i+"-"+s},confirmSelect:function(){var t=new Date,e=t.getFullYear(),i=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,s=t.getDate()<10?"0"+t.getDate():t.getDate(),c=e+"-"+i+"-"+s;this.showSelectPopup=!1,this.ticketInfo.selectPlayDate=""==this.currentPlayDate?c:this.currentPlayDate},cancelSelect:function(){this.showSelectPopup=!1},addTourist:function(){this.isEdit=!0,this.name="",this.idCard=""},editTourist:function(t){var e=this;this.isEdit=!0,console.log("编辑"),this.touristList.forEach((function(i,s){i.idCard==t.idCard&&(e.touristList.splice(s,1),s++)})),console.log(this.touristList)},deleteTourist:function(t){var e=this;a["a"].confirm({title:"温馨提示",message:"确定删除该游客信息？"}).then((function(){e.touristList.forEach((function(i,s){i.idCard==t.idCard&&(e.touristList.splice(s,1),s++)}))})).catch((function(){}))},pay:function(){if(this.ticketInfo.touristsNumber=this.touristList.length,this.ticketInfo.ticketPay=this.ticketPay,Object(o["c"])(this.ticketInfo.selectTicketType))Object(n["a"])("购票类型不能为空");else if(Object(o["c"])(this.ticketInfo.selectPlayDate))Object(n["a"])("游玩日期不能为空");else if(0!=this.ticketInfo.touristsNumber){console.log(this.ticketInfo);var t={selectPlayDate:this.ticketInfo.selectPlayDate,number:Number(this.ticketInfo.touristsNumber),ticketPay:this.ticketPay,uTel:this.userTel,ticketId:this.ticketInfo.ticketId};console.log(t),Object(r["b"])(t,"post").then((function(t){"200"==t.code?Object(n["a"])("购票成功，可前往个人中心查看购票信息"):Object(n["a"])("您已预约对应时间段")})).catch((function(t){Object(n["a"])("登录失败")})),n["a"].success("支付成功")}else Object(n["a"])("游玩人数不能为0")},editTourists:function(){var t={name:this.name,idCard:this.idCard,ticketType:0};Object(o["c"])(t.name)?Object(n["a"])("姓名不能为空"):Object(o["c"])(t.idCard)?Object(n["a"])("证件号码不能为空"):Object(o["b"])(t.name)?Object(o["a"])(t.idCard)?(console.log(t),this.touristList.push(t),console.log(this.touristList),this.isEdit=!1):Object(n["a"])("证件号码格式有误"):Object(n["a"])("姓名格式有误")}}},u=l,f=(i("08b2"),i("2877")),d=Object(f["a"])(u,s,c,!1,null,"2bf39f1a",null);e["default"]=d.exports}}]);
//# sourceMappingURL=chunk-e14d1d40.4ad1fa5c.js.map