(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b2b90d66"],{"159b":function(t,e,i){var s=i("da84"),a=i("fdbc"),n=i("17c2"),c=i("9112");for(var r in a){var o=s[r],u=o&&o.prototype;if(u&&u.forEach!==n)try{c(u,"forEach",n)}catch(l){u.forEach=n}}},"17c2":function(t,e,i){"use strict";var s=i("b727").forEach,a=i("b301");t.exports=a("forEach")?function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}:[].forEach},"2f27":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"userCenter"},[i("div",{staticClass:"user-info"},[i("div",{staticClass:"user-card"},[t.isLogin?i("div",{staticClass:"user-type"}):t._e(),t.isLogin?i("div",{staticClass:"user-type-desc"},[t._v(t._s(t.user.userType?"尊贵会员":"普通用户"))]):t._e(),i("div",{staticClass:"user-portrait"}),t.isLogin?i("div",{staticClass:"user-name"},[t._v(t._s(t.user.nickName))]):t._e(),t.isLogin?i("div",{staticClass:"user-tel"},[t._v(t._s(t.telShow))]):t._e(),t.isLogin?t._e():i("div",{staticClass:"user-login",on:{click:t.goLogin}},[t._v("尚未登录，请跳转登录 "),t._m(0)])])]),i("van-collapse",{staticStyle:{"margin-top":"90px"},attrs:{accordion:""},model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[i("van-collapse-item",{class:"myTicket"==t.activeNames?"active":"",attrs:{name:"myTicket"}},[i("div",{staticClass:"collapse-title",attrs:{slot:"title"},slot:"title"},[i("span",{staticClass:"icon iconfont collapse-icon"},[t._v("")]),i("span",[t._v("我的门票")])]),t._l(t.ticketList,(function(e,s){return i("van-card",{key:s,attrs:{num:e.number,price:e.ticketPay,title:e.title,thumb:e.image},on:{click:function(i){return t.showTicketDetail("ticket",e)}}},[i("div",{attrs:{slot:"tags"},slot:"tags"},[i("div",[t._v(t._s(e.descs))]),i("div",[t._v("日期："+t._s(e.selectPlayDate))]),1==e.status?i("div",{staticClass:"logo unused"},[t._v("未使用")]):t._e(),2==e.status?i("div",{staticClass:"logo overdue"},[t._v("已使用")]):t._e()])])}))],2),i("van-collapse-item",{class:"myParking"==t.activeNames?"active":"",attrs:{name:"myParking"}},[i("div",{staticClass:"collapse-title",attrs:{slot:"title"},slot:"title"},[i("span",{staticClass:"icon iconfont collapse-icon"},[t._v("")]),i("span",[t._v("我的停车")])]),t._l(t.parkingList,(function(e,s){return i("van-card",{key:s,attrs:{price:e.price,title:e.carNum,desc:e.area+"~"+e.num,thumb:e.thumb},on:{click:function(i){return t.showTicketDetail("parking",e)}}},[i("div",{attrs:{slot:"tags"},slot:"tags"},[i("div",[t._v("时间:"+t._s(e.parkingStartTime+"~"+e.parkingEndTime))]),0==e.status?i("div",{staticClass:"logo used"},[t._v("已使用")]):t._e(),1==e.status?i("div",{staticClass:"logo unused"},[t._v("未使用")]):t._e(),2==e.status?i("div",{staticClass:"logo overdue"},[t._v("已过期")]):t._e()])])}))],2)],1),t.isLogin?i("van-button",{attrs:{type:"danger",size:"large"},on:{click:t.loginOut}},[t._v("退出登录")]):t._e()],1)},a=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",{staticClass:"icon-go"},[i("span",{staticClass:"icon iconfont icon-xiangyou"})])}],n=(i("159b"),i("e7e5"),i("d399")),c=i("5355"),r={name:"userCenter",data:function(){return{user:{nickName:"",tel:"",userType:0},userTel:"",isLogin:!0,activeNames:"",ticketList:[],parkingList:[]}},computed:{telShow:function(){return this.user.tel.substr(0,3)+"****"+this.user.tel.substr(7)}},mounted:function(){var t=this;this.userTel=sessionStorage.getItem("userTel"),this.userTel?(this.isLogin=!0,Object(c["m"])({tel:this.userTel},"get").then((function(e){t.user={nickName:e.nickName,tel:e.tel,userType:e.userType},t.getParkingList(),t.getTicketList()})).catch((function(t){Object(n["a"])("获取个人信息失败")}))):this.isLogin=!1},methods:{timestampToTime:function(t){var e=new Date(t),i=e.getFullYear()+"-",s=(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-",a=(e.getDate()<10?"0"+e.getDate():e.getDate())+" ";return i+s+a},getParkingList:function(){var t=this;Object(c["i"])({tel:this.userTel},"get").then((function(e){if(0!=e.length){for(var i={},s=0;s<e.length;s++)i={carNum:e[s].carNum,parkingStartTime:t.timestampToTime(e[s].startTime),parkingEndTime:t.timestampToTime(e[s].endTime),area:e[s].area,num:e[s].num,price:e[s].price+".00",thumb:e[s].thumb,status:e[s].status},t.parkingList.push(i);console.log(t.parkingList)}})).catch((function(t){Object(n["a"])("获取我的停车失败")}))},getTicketList:function(){var t=this;Object(c["c"])({tel:this.userTel},"get").then((function(e){if(0!=e.length){for(var i=0;i<e.length;i++){var s={};s={selectPlayDate:t.timestampToTime(e[i].selectPlayDate),number:e[i].number,ticketId:e[i].ticketId,ticketPay:e[i].ticketPay+".00",status:e[i].status,image:"https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1590039758079&di=8dc3d04fcc968026646efbf43df0a655&imgtype=0&src=http%3A%2F%2Fhbimg.b0.upaiyun.com%2F60318eb10e8b6ecf4b7ca1eee0bed8749d30b52621857-3pjuGn_fw658"},t.ticketList.push(s)}t.getTicketDetail()}})).catch((function(t){Object(n["a"])("获取我的门票失败")}))},getTicketDetail:function(){var t=this;this.ticketList.forEach((function(e,i){Object(c["f"])({ticketId:e.ticketId},"get").then((function(e){t.ticketList[i].title=e[0].title,t.ticketList[i].descs=e[0].descs})).catch((function(t){Object(n["a"])("获取电子门票信息失败")}))}))},showTicketDetail:function(t,e){console.log("点击跳转"),console.log(e),"1"==e.status&&("ticket"==t?this.$router.push({path:"/userCenter/ticketDetail",query:{item:e}}):this.$router.push({path:"/userCenter/parkingDetail",query:{carNum:e.carNum,parkingStartTime:this.timestampToTime(e.parkingStartTime),parkingEndTime:this.timestampToTime(e.parkingEndTime),area:e.area,num:e.num,price:e.price}}))},goLogin:function(){this.$router.push({path:"/login"})},loginOut:function(){sessionStorage.removeItem("userTel"),this.$router.push({path:"/login"})}}},o=r,u=(i("e4c7"),i("2877")),l=Object(u["a"])(o,s,a,!1,null,null,null);e["default"]=l.exports},a19a:function(t,e,i){},e4c7:function(t,e,i){"use strict";var s=i("a19a"),a=i.n(s);a.a}}]);
//# sourceMappingURL=chunk-b2b90d66.d0b95832.js.map